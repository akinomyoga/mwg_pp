#!/usr/bin/env ./ev3v2.awk
// -*- mode:c++ -*-
__EV3_CHECK_HEAP__=1;

puts("== lambda ==");
assert=()=> eval(arguments[0])||printf(sgr_error+"assertion failed\e[m: %sexpr = (%s).\n",arguments[1]!=NULL?arguments[1]+"\n  ":"",arguments[0]);
sgr_error="\e[1;32m";
assert('false',"this message is expected");
sgr_error="\e[1;31m";
assert('1');
assert('!null');

print=puts;

f=()=>{r+=":"+(++x)};
r=x=1;f();f();print(r);
arguments=[0,1];

// 現在の実装だと循環参照になるので。
f=null;
assert=null;
